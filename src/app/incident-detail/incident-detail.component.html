<div *ngIf="incident" class="bg-white p-8 rounded-lg shadow-md">
  <h1 class="text-3xl font-bold mb-6 text-gray-800">Incident Details - {{ incident.id }}</h1>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div>
      <h2 class="text-xl font-semibold mb-2 text-gray-700">Report Information</h2>
      <p class="text-gray-700 mb-2"><span class="font-medium">Type:</span> {{ incident.type }}</p>
      <p class="text-gray-700 mb-2"><span class="font-medium">Description:</span> {{ incident.description }}</p>
      <p class="text-gray-700 mb-2"><span class="font-medium">Location:</span> {{ incident.location }} (Lat: {{ incident.latitude }}, Lng: {{ incident.longitude }})</p>
      <p class="text-gray-700 mb-2"><span class="font-medium">Reported By:</span> {{ incident.user_name }}</p>
      <p class="text-gray-700 mb-2"><span class="font-medium">Reported At:</span> {{ incident.created_at | date:'medium' }}</p>
      <p class="text-gray-700 mb-2">
        <span class="font-medium">Current Status:</span>
        <span [ngClass]="{
          'px-3 py-1 inline-flex text-sm leading-5 font-semibold rounded-full ml-2': true,
          'bg-yellow-100 text-yellow-800': incident.status === 'PENDING',
          'bg-green-100 text-green-800': incident.status === 'VALIDATED' || incident.status === 'dispatched',
          'bg-red-100 text-red-800': incident.status === 'REJECTED' || incident.status === 'false'
        }">
          {{ incident.status | titlecase }}
        </span>
      </p>
    </div>

    <div>
      <h2 class="text-xl font-semibold mb-2 text-gray-700">Attachments (Photos/Videos)</h2>
      <div class="grid grid-cols-2 gap-4">
        <div *ngFor="let photo of incident.photos">
          <img [src]="photo" alt="Incident Photo" class="w-full h-32 object-cover rounded-md shadow-sm">
        </div>
        <p *ngIf="!incident.photos || incident.photos.length === 0" class="text-gray-500">No attachments.</p>
      </div>
    </div>

    <div class="col-span-full w-full">
      <h2 class="text-xl font-semibold mt-6 mb-2 text-gray-700">Map Location</h2>

      <app-map *ngIf="incident" [incidents]="[incident.data]" class="w-full"></app-map>
    </div>
  </div>

  <div class="mt-8 pt-6 border-t border-gray-200 flex space-x-4">
    <button *ngIf="incident.status === 'PENDING'" (click)="validateIncident()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg transition-colors duration-200">
      <i class="fas fa-check mr-2"></i> Mark as Validated
    </button>
    <button *ngIf="incident.status === 'PENDING'" (click)="rejectIncident()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition-colors duration-200">
      <i class="fas fa-times mr-2"></i> Reject Report
    </button>
    <button *ngIf="incident.status === 'VALIDATED'" (click)="dispatchAlert()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors duration-200">
      <i class="fas fa-paper-plane mr-2"></i> Dispatch Alert
    </button>
    <button (click)="goBack()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg transition-colors duration-200">
      <i class="fas fa-arrow-left mr-2"></i> Back to List
    </button>
  </div>
</div>

<div *ngIf="!incident" class="text-center text-gray-500 py-10">
  Incident not found.
</div>
